#!/usr/bin/env node

/* jslint node:true */
var _ = require('underscore');
var logSetup = require('./log-setup');
var minimist = require('minimist');
var JuttledService = require('../lib/service-juttled');

var defaults = {
    'port': 8080,
    'root': '/'
};

function usage() {
    console.log('usage: [--port <port>] [--root <path>]');
    console.log('       --port <port>: Run outriggerd on specified port');
    console.log('       --root <path>: Use <path> as the root directory for juttle programs.');
    process.exit(1);
}

var opts = minimist(process.argv.slice(2));

_.defaults(opts, defaults);

if (opts.help) {
    usage();
}

opts.port = opts['port'];

logSetup.init();
require('log4js').getLogger('demo').debug('initializing');

new JuttledService({port: opts.port, root_directory: opts.root});
